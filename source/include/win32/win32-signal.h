/*******************************************************************************
 * Copyright (c) 2011, Jean-David Gadina <macmade@eosgarden.com>
 * Distributed under the Boost Software License, Version 1.0.
 * 
 * Boost Software License - Version 1.0 - August 17th, 2003
 * 
 * Permission is hereby granted, free of charge, to any person or organization
 * obtaining a copy of the software and accompanying documentation covered by
 * this license (the "Software") to use, reproduce, display, distribute,
 * execute, and transmit the Software, and to prepare derivative works of the
 * Software, and to permit third-parties to whom the Software is furnished to
 * do so, all subject to the following:
 * 
 * The copyright notices in the Software and this entire statement, including
 * the above license grant, this restriction and the following disclaimer,
 * must be included in all copies of the Software, in whole or in part, and
 * all derivative works of the Software, unless such copies or derivative
 * works are solely in the form of machine-executable object code generated by
 * a source language processor.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
 * SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
 * FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 ******************************************************************************/
 
/* $Id$ */

/*!
 * @header      signal.h
 * @copyright   eosgarden 2011 - Jean-David Gadina <macmade@eosgarden.com>
 * @abstract    Signal functions for Windows
 */

#ifndef _XS_WIN32_SIGNAL_H_
#define _XS_WIN32_SIGNAL_H_
#pragma once

#ifdef __cplusplus
extern "C" {
#endif

#include <stdint.h>
#include "win32-types.h"

/*******************************************************************************
 * Standard POSXI signal types
 ******************************************************************************/

#ifndef SIGABRT
#define SIGABRT     0x01    /* Abort */
#endif

#ifndef SIGALRM
#define SIGALRM     0x02    /* Alarm */
#endif

#ifndef SIGFPE
#define SIGFPE      0x03    /* Floating point exception */
#endif

#ifndef SIGHUP
#define SIGHUP      0x04    /* Hang-up */
#endif

#ifndef SIGILL
#define SIGILL      0x05    /* Illegal instruction */
#endif

#ifndef SIGINT
#define SIGINT      0x06    /* Interrupt request */
#endif

#ifndef SIGKILL
#define SIGKILL     0x07    /* Kill process */
#endif

#ifndef SIGPIPE
#define SIGPIPE     0x08    /* Pipe exception */
#endif

#ifndef SIGQUIT
#define SIGQUIT     0x09    /* Core dump */
#endif

#ifndef SIGSEGV
#define SIGSEGV     0x0A    /* Segmentation fault */
#endif

#ifndef SIGTERM
#define SIGTERM     0x0B    /* Process termination request */
#endif

#ifndef SIGUSR1
#define SIGUSR1     0x0C    /* User defined condition */
#endif

#ifndef SIGUSR2
#define SIGUSR2     0x0D    /* User defined consition */
#endif

#ifndef SIGCHLD
#define SIGCHLD     0x0E    /* Child process termination */
#endif

#ifndef SIGCONT
#define SIGCONT     0x0F    /* Process restart */
#endif

#ifndef SIGSTOP
#define SIGSTOP     0x10    /* Process stop */
#endif

#ifndef SIGTSTP
#define SIGTSTP     0x11    /* Process pause */
#endif

#ifndef SIGTTIN
#define SIGTTIN     0x12    /* TTY read */
#endif

#ifndef SIGTTOU
#define SIGTTOU     0x13    /* TTY write */
#endif

#ifndef SIGBUS
#define SIGBUS      0x14    /* Bus error */
#endif

#ifndef SIGPOLL
#define SIGPOLL     0x15    /* Asynchronous I/O event */
#endif

#ifndef SIGPROF
#define SIGPROF     0x16    /* Profiling timer expiration */
#endif

#ifndef SIGSYS
#define SIGSYS      0x17    /* Bad system call argument */
#endif

#ifndef SIGTRAP
#define SIGTRAP     0x18    /* Debugger condition */
#endif

#ifndef SIGURG
#define SIGURG      0x19    /* Urgent data in socket */
#endif

#ifndef SIGVTALRM
#define SIGVTALRM   0x1A    /* Time limit elapsed */
#endif

#ifndef SIGXCPU
#define SIGXCPU     0x1B    /* Exceeded CPU time */
#endif

#ifndef SIGXFSZ
#define SIGXFSZ     0x1C    /* Allowed file size exceeded */
#endif

typedef uint64_t sigset_t;

union sigval
{
    int    sival_int;
    void * sival_ptr;
};

typedef struct
{
	int          si_signo;
	int          si_code;
	union sigval si_value;
	int          si_errno;
	pid_t        si_pid;
	uid_t        si_uid;
	void       * si_addr;
	int          si_status;
	int          si_band;
}
siginfo_t;

struct sigaction
{
    void ( * sa_handler )( int );
    sigset_t sa_mask;
    int      sa_flags;
    void ( * sa_sigaction )( int, siginfo_t *, void * );
};

int sigemptyset( sigset_t * set );
int sigaction( int sig, const struct sigaction * act, struct sigaction * oact );
    
    
#ifdef __cplusplus
}
#endif

#endif /* _XS_WIN32_SIGNAL_H_ */
